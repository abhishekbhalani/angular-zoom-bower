!function(){var e=angular.module("dotjem.angular.zoom",["dotjem.angular.events"]);e.service("dxZoomViewModel",function(){function e(){if(o.$size&&o.bounds){var e=o.$scale,t=o.bounds.width/o.$size.width,i=e*t,n=-(o.position.x*e)+o.bounds.width/2,s=-(o.position.y*e)+o.bounds.height/2;o.zoomStyles={transform:"translate("+n+"px, "+s+"px) scale("+i+")"}}}var o=this;o.show=function(t,i,n,s){o.image=t,o.visible=i,o.bounds=n,o.styles=s,o.viewStyles=angular.extend(s,{top:n.y,width:n.width,height:n.height}),e()},o.zoom=function(t){o.$scale=t,o.zoomScale=2>t?t.toFixed(2):4>t?t.toFixed(1):Math.floor(t),e()},o.move=function(t,i){o.position={x:t,y:i},e()},o.ready=function(t){o.$size=t,e()}}),e.component("dxZoomView",{template:'<div class="dx-container" ng-style="$ctrl.model.viewStyles" ng-if="$ctrl.model.visible" style="position: absolute; z-index: 99;">   <img ng-src="{{ $ctrl.model.image }}" ng-style="$ctrl.model.zoomStyles" dx-image-ready="$ctrl.ready($event)">   <div class="dx-zoom-view-info">Scale: {{ $ctrl.model.zoomScale }}x</div></div>',controller:["dxZoomViewModel",function(e){var o=this;o.model=e,o.ready=function(o){o=o.element[0],e.ready({width:o.naturalWidth,height:o.naturalHeight})}}]}),e.component("dxZoom",{template:'<div class="dx-overlay"     ng-mousemove="$ctrl.onMouseMove($event)"     ng-mouseleave="$ctrl.toggle($event,false);"     ng-mouseenter="$ctrl.toggle($event,true);"     dx-mouse-wheel="$ctrl.onMouseWheel($event)"></div><div class="dx-zoom-box" ng-style="$ctrl.boxStyles" ng-if="$ctrl.show"></div><div><img ng-src="{{ $ctrl.image }}" dx-image-ready="$ctrl.imageReady($event)" style="width: 100%;"></div>',bindings:{image:"@",enabled:"=",zoomImage:"@",zoomStyle:"="},controller:["$element","dxZoomViewModel",function(e,o){function t(){i.boxStyles={left:i.$pos.x-i.$size/2+"px",top:i.$pos.y-i.$size*i.$ratio/2+"px",width:i.$size+"px",height:i.$size*i.$ratio+"px"}}var i=this,n=o;i.$ratio=1,i.$size=100,i.$pos={x:0,y:0},i.imageReady=function(e){e=e.element[0],i.$bounds={w:e.naturalWidth,h:e.naturalHeight},i.$ratio=i.$bounds.h/i.$bounds.w},i.toggle=function(o,s){i.show=s;var l=e.offset();n.show(i.zoomImage,s,{x:l.left,y:l.top,width:e.width(),height:e.height(),imageSize:{width:i.$bounds.w,height:i.$bounds.h}},i.zoomStyle),n.zoom(e.width()/i.$size),t()},i.onMouseMove=function(e){n.move(e.offsetX,e.offsetY),i.$pos.x=e.offsetX,i.$pos.y=e.offsetY,t()},i.onMouseWheel=function(o){var s=-(o.deltaY/Math.abs(o.deltaY)),l=i.$size+10*s;10>l&&(l=10),l>e.width()&&(l=e.width()),n.zoom(e.width()/l),i.$size=l,o.stopImmediatePropagation(),o.stopPropagation(),o.preventDefault(),t()}}]})}();